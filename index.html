<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Runaway 驿站</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="description" content="托福、SAT、GRE等考试备考资源">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
  <style>
    :root {
      --theme-color: #3273dc;
      --theme-color-dark: #2160c4;
      --text-color-base: #2c3e50;
      --text-color-secondary: #476582;
      --text-color-tertiary: #999;
    }

    .answer-section {
      display: none;
      padding: 10px;
      margin: 10px 0;
      border-left: 4px solid var(--theme-color);
      background-color: #f8f8f8;
    }
    .show-answer-btn {
      background-color: var(--theme-color);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin: 10px 0;
      font-size: 14px;
    }
    .show-answer-btn:hover {
      background-color: var(--theme-color-dark);
    }
    .sidebar-nav li.active {
      background-color: rgba(50, 115, 220, 0.1);
    }
    .sidebar-nav li.active a {
      font-weight: bold;
      color: var(--theme-color);
    }
    .siblings-nav {
      display: flex;
      justify-content: space-between;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }
    .siblings-nav a {
      color: var(--theme-color);
      text-decoration: none;
    }
    .app-name {
      display: none;
    }
    .app-name-link {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 15px 0;
      color: var(--theme-color) !important;
      font-size: 1.5rem !important;
      font-weight: 600;
      text-decoration: none !important;
      transition: all 0.3s ease;
    }
    .app-name-link:hover {
      transform: scale(1.02);
    }
    .app-name-link img {
      height: 50px;
      margin-right: 15px;
      filter: drop-shadow(0 2px 5px rgba(0, 0, 0, 0.1));
    }
    .app-name-link span {
      background: linear-gradient(to right, #3273dc, #4e92ff);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 700;
      letter-spacing: 0.5px;
    }
    
    /* 自定义主题色 */
    .markdown-section a {
      color: var(--theme-color);
    }
    .markdown-section blockquote {
      border-left: 4px solid var(--theme-color);
    }
    .markdown-section h1, 
    .markdown-section h2, 
    .markdown-section h3, 
    .markdown-section h4, 
    .markdown-section h5, 
    .markdown-section h6 {
      color: var(--text-color-base);
    }
    .markdown-section h1 {
      border-bottom: 1px solid #eaecef;
    }
    .search input {
      border: 1px solid #eaecef;
    }
    .search input:focus {
      border: 1px solid var(--theme-color);
    }
    .search .search-keyword {
      color: var(--theme-color);
    }
    .sidebar ul li.active>a {
      color: var(--theme-color);
      border-right: 2px solid var(--theme-color);
    }
    .sidebar-toggle {
      background-color: transparent;
    }
    .sidebar-toggle span {
      background-color: var(--theme-color);
    }
    .docsify-pagination-container {
      border-top: 1px solid #eaecef;
    }
    .docsify-pagination-container .pagination-item-title {
      color: var(--theme-color);
    }
    
    /* 侧边栏样式优化 */
    .sidebar {
      background-color: #f8fafc;
      border-right: 1px solid rgba(234, 236, 239, 0.5);
    }
    .sidebar-nav {
      padding: 0 15px;
    }
    .sidebar-nav > ul > li {
      margin: 6px 0;
    }
    .sidebar-nav > ul > li > a {
      font-weight: 600;
      color: var(--text-color-base);
    }
    .sidebar-nav ul li a {
      padding: 4px 0;
      transition: all 0.2s ease;
    }
    .sidebar-nav ul li a:hover {
      text-decoration: none;
      color: var(--theme-color);
    }
    .sidebar-nav ul li.active > a {
      color: var(--theme-color);
      border-right: 2px solid var(--theme-color);
      background-color: rgba(50, 115, 220, 0.05);
      padding-left: 5px;
      border-radius: 3px 0 0 3px;
    }
    
    /* 内容区域样式优化 */
    .content {
      padding-top: 10px;
    }
    .markdown-section {
      max-width: 900px;
      padding: 30px 30px 40px;
    }
    
    /* 移动端适配优化 */
    @media screen and (max-width: 768px) {
      .app-name-link {
        font-size: 1.2rem !important;
      }
      .app-name-link img {
        height: 40px;
      }
      .markdown-section {
        padding: 20px 15px;
      }
    }
    
    /* 自定义logo和站名样式 */
    .sidebar .app-name {
      display: block;
      padding: 0;
      background: none;
      box-shadow: none;
      border: none;
      margin-bottom: 10px;
    }
    .sidebar .app-name-link {
      display: flex;
      flex-direction: row;
      align-items: center;
      padding: 10px 0;
    }
    .sidebar .app-name-link img {
      height: 40px;
      margin-right: 10px;
    }
    .sidebar .app-name-link span {
      font-size: 1.2rem;
    }
    
    /* 添加站点描述 */
    .sidebar .site-description {
      font-size: 0.8rem;
      color: var(--text-color-tertiary);
      text-align: center;
      margin-top: -5px;
      margin-bottom: 10px;
    }
    
    body > .app-name {
      display: none;
    }
    
    /* 调整内容区域上边距 */
    .content {
      padding-top: 0;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <script>
    window.$docsify = {
      el: '#app',
      loadSidebar: true,
      subMaxLevel: 3,
      name: 'Runaway 驿站',
      nameLink: '/',
      logo: './assets/images/logo.png',
      repo: '',
      auto2top: true,
      relativePath: true,
      basePath: '',
      mergeNavbar: true,
      alias: {
        '/_sidebar.md': '/_sidebar.md'
      },
      requestHeaders: {
        'cache-control': 'max-age=0'
      },
      notFoundPage: true,
      plugins: [
        function(hook, vm) {
          // 模板处理插件
          hook.beforeEach(function(content) {
            // 检查是否是真题页面
            if (vm.route.path.includes('/toefl/listening/real-exams/')) {
              // 处理YAML front matter
              const yamlMatch = content.match(/---\n([\s\S]*?)\n---/);
              if (yamlMatch) {
                const yamlContent = yamlMatch[1];
                const lines = yamlContent.split('\n');
                const metadata = {};
                
                lines.forEach(line => {
                  const parts = line.split(':');
                  if (parts.length >= 2) {
                    const key = parts[0].trim();
                    const value = parts.slice(1).join(':').trim();
                    metadata[key] = value;
                  }
                });
                
                // 移除YAML front matter
                content = content.replace(/---\n[\s\S]*?\n---/, '');
                
                // 添加标题和元数据
                let header = `# ${metadata.title || ''}\n\n`;
                header += `> [小红书 @Sr](https://www.xiaohongshu.com/user/profile/65c8a2f3000000000b036b41)  更新时间：${metadata.date || ''}\n\n`;
                header += `!> 更佳刷题体验欢迎前往 [Runaway 本站](https://www.runaway.cc/)（runaway.cc）。\n\n`;
                
                // 添加视频（如果有）
                if (metadata.videoUrl) {
                  header += `### 笔记视频\n\n`;
                  header += `<div style="position: relative; padding-bottom: 40%; height: 0; max-width: 80%; margin: 0 auto;">\n`;
                  header += `  <iframe src="${metadata.videoUrl}" \n`;
                  header += `          style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;" \n`;
                  header += `          frameborder="0" \n`;
                  header += `          allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture" \n`;
                  header += `          allowfullscreen>\n`;
                  header += `  </iframe>\n`;
                  header += `</div>\n\n`;
                  header += `> 如果视频无法播放，请访问[小红书 @Sr](https://www.xiaohongshu.com/user/profile/65c8a2f3000000000b036b41) 观看视频。\n\n`;
                }
                
                content = header + content;
              }
              
              // 替换模板标记
              content = content.replace(/\{\{question\}\}/g, '<div class="question-section">');
              content = content.replace(/\{\{\/question\}\}/g, '</div>');
              
              content = content.replace(/\{\{answer\}\}/g, '<div class="answer-section">');
              content = content.replace(/\{\{\/answer\}\}/g, '</div><button class="show-answer-btn">显示答案</button>');
            }
            return content;
          });
          
          // 在DOM准备好后添加事件监听
          hook.doneEach(function() {
            // 为所有"显示答案"按钮添加点击事件
            const buttons = document.querySelectorAll('.show-answer-btn');
            buttons.forEach(button => {
              button.addEventListener('click', function() {
                const answerSection = this.previousElementSibling;
                if (answerSection.style.display === 'block') {
                  answerSection.style.display = 'none';
                  this.textContent = '显示答案';
                } else {
                  answerSection.style.display = 'block';
                  this.textContent = '隐藏答案';
                }
              });
            });
            
            // 添加站点描述
            const appName = document.querySelector('.sidebar .app-name');
            if (appName) {
              const siteDesc = document.createElement('div');
              siteDesc.className = 'site-description';
              siteDesc.textContent = 'Runaway 驿站';
              
              // 在app-name之后插入描述
              appName.parentNode.insertBefore(siteDesc, appName.nextSibling);
            }
            
            // 添加上一篇/下一篇导航
            if (vm.route.path.includes('/toefl/')) {
              const content = document.querySelector('.content');
              if (content) {
                const currentPath = vm.route.path;
                const sidebar = document.querySelector('.sidebar-nav');
                
                if (sidebar) {
                  const links = Array.from(sidebar.querySelectorAll('a'));
                  const currentIndex = links.findIndex(link => {
                    const href = link.getAttribute('href');
                    return href === `#${currentPath}` || href === `#${currentPath}/`;
                  });
                  
                  if (currentIndex !== -1) {
                    const prevLink = links[currentIndex - 1];
                    const nextLink = links[currentIndex + 1];
                    
                    let navHTML = '<div class="siblings-nav">';
                    
                    if (prevLink) {
                      navHTML += `<a href="${prevLink.getAttribute('href')}" class="prev-link">« ${prevLink.textContent}</a>`;
                    } else {
                      navHTML += '<span></span>';
                    }
                    
                    if (nextLink) {
                      navHTML += `<a href="${nextLink.getAttribute('href')}" class="next-link">${nextLink.textContent} »</a>`;
                    } else {
                      navHTML += '<span></span>';
                    }
                    
                    navHTML += '</div>';
                    
                    // 添加到内容底部
                    const article = content.querySelector('article.markdown-section');
                    if (article) {
                      const navElement = document.createElement('div');
                      navElement.innerHTML = navHTML;
                      article.appendChild(navElement.firstChild);
                    }
                  }
                }
              }
            }
          });
        }
      ]
    }
  </script>
  <!-- Docsify v4 -->
  <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/docsify.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/docsify-pagination/dist/docsify-pagination.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-bash.min.js"></script>
</body>
</html>
